if(typeof(PhpDebugBar)=="undefined"){var PhpDebugBar={};PhpDebugBar.$=jQuery}(function(p){if(typeof(localStorage)=="undefined"){localStorage={setItem:function(b,a){},getItem:function(a){return null}}}if(typeof(PhpDebugBar.utils)=="undefined"){PhpDebugBar.utils={}}var m=PhpDebugBar.utils.getDictValue=function(d,a,c){var e=d,f=a.split(".");for(var b=0;b<f.length;b++){if(!e[f[b]]){return c}e=e[f[b]]}return e};var l=PhpDebugBar.utils.getObjectSize=function(c){if(Object.keys){return Object.keys(c).length}var a=0;for(var b in c){if(c.hasOwnProperty(b)){a++}}return a};PhpDebugBar.utils.csscls=function(b,e){if(b.indexOf(" ")>-1){var c=b.split(" "),a=[];for(var f=0,d=c.length;f<d;f++){a.push(PhpDebugBar.utils.csscls(c[f],e))}return a.join(" ")}if(b.indexOf(".")===0){return"."+e+b.substr(1)}return e+b};PhpDebugBar.utils.makecsscls=function(a){var b=function(c){return PhpDebugBar.utils.csscls(c,a)};return b};var r=PhpDebugBar.utils.makecsscls("phpdebugbar-");var o=PhpDebugBar.Widget=function(a){this._attributes=p.extend({},this.defaults);this._boundAttributes={};this.$el=p("<"+this.tagName+" />");if(this.className){this.$el.addClass(this.className)}this.initialize.apply(this,[a||{}]);this.render.apply(this)};p.extend(o.prototype,{tagName:"div",className:null,defaults:{},initialize:function(a){this.set(a)},render:function(){},set:function(b,d){if(typeof(b)!="string"){for(var a in b){this.set(a,b[a])}return}this._attributes[b]=d;if(typeof(this._boundAttributes[b])!=="undefined"){for(var e=0,c=this._boundAttributes[b].length;e<c;e++){this._boundAttributes[b][e].apply(this,[d])}}},has:function(a){return typeof(this._attributes[a])!=="undefined"&&this._attributes[a]!==null},get:function(a){return this._attributes[a]},bindAttr:function(b,c){if(p.isArray(b)){for(var a=0,d=b.length;a<d;a++){this.bindAttr(b[a],c)}return}if(typeof(this._boundAttributes[b])=="undefined"){this._boundAttributes[b]=[]}if(typeof(c)=="object"){var e=c;c=function(f){e.text(f||"")}}this._boundAttributes[b].push(c);if(this.has(b)){c.apply(this,[this._attributes[b]])}}});o.extend=function(b){var c=this;var d=function(){return c.apply(this,arguments)};p.extend(d,c);var a=function(){this.constructor=d};a.prototype=c.prototype;d.prototype=new a;p.extend(d.prototype,b);d.__super__=c.prototype;return d};var t=o.extend({className:r("panel"),render:function(){this.$tab=p("<a />").addClass(r("tab"));this.$icon=p("<i />").appendTo(this.$tab);this.bindAttr("icon",function(a){if(a){this.$icon.attr("class","phpdebugbar-fa phpdebugbar-fa-"+a)}else{this.$icon.attr("class","")}});this.bindAttr("title",p("<span />").addClass(r("text")).appendTo(this.$tab));this.$badge=p("<span />").addClass(r("badge")).appendTo(this.$tab);this.bindAttr("badge",function(a){if(a!==null){this.$badge.text(a);this.$badge.show()}else{this.$badge.hide()}});this.bindAttr("widget",function(a){this.$el.empty().append(a.$el)});this.bindAttr("data",function(a){if(this.has("widget")){this.get("widget").set("data",a)}})}});var k=o.extend({tagName:"span",className:r("indicator"),render:function(){this.$icon=p("<i />").appendTo(this.$el);this.bindAttr("icon",function(a){if(a){this.$icon.attr("class","phpdebugbar-fa phpdebugbar-fa-"+a)}else{this.$icon.attr("class","")}});this.bindAttr(["title","data"],p("<span />").addClass(r("text")).appendTo(this.$el));this.$tooltip=p("<span />").addClass(r("tooltip disabled")).appendTo(this.$el);this.bindAttr("tooltip",function(a){if(a){this.$tooltip.text(a).removeClass(r("disabled"))}else{this.$tooltip.addClass(r("disabled"))}})}});var n=PhpDebugBar.DatasetTitleFormater=function(a){this.debugbar=a};p.extend(n.prototype,{format:function(d,f,e){if(e){e=" "+e}else{e=""}var c=l(this.debugbar.datasets)+1;if(typeof(f.__meta)==="undefined"){return"#"+c+e}var b=f.__meta.uri.substr(f.__meta.uri.lastIndexOf("/")+1);var a="#"+c+" "+b+e+" ("+f.__meta.datetime.split(" ")[1]+")";return a}});var s=PhpDebugBar.DebugBar=o.extend({className:"phpdebugbar "+r("minimized"),options:{bodyMarginBottom:true,bodyMarginBottomHeight:parseInt(p("body").css("margin-bottom"))},initialize:function(){this.controls={};this.dataMap={};this.datasets={};this.firstTabName=null;this.activePanelName=null;this.datesetTitleFormater=new n(this);this.registerResizeHandler()},registerResizeHandler:function(){if(typeof this.resize.bind=="undefined"){return}var a=this.resize.bind(this);this.respCSSSize=0;p(window).resize(a);setTimeout(a,20)},resize:function(){var d=this.respCSSSize;if(this.respCSSSize==0){this.$header.find("> div > *:visible").each(function(){d+=p(this).outerWidth()})}var a=this.$header.width();var c="phpdebugbar-mini-design";var b=this.$header.hasClass(c);if(a<=d&&!b){this.respCSSSize=d;this.$header.addClass(c)}else{if(d<a&&b){this.respCSSSize=0;this.$header.removeClass(c)}}this.setHeight(this.$body.height())},render:function(){var b=this;this.$el.appendTo("body");this.$dragCapture=p("<div />").addClass(r("drag-capture")).appendTo(this.$el);this.$resizehdle=p("<div />").addClass(r("resize-handle")).appendTo(this.$el);this.$header=p("<div />").addClass(r("header")).appendTo(this.$el);this.$headerLeft=p("<div />").addClass(r("header-left")).appendTo(this.$header);this.$headerRight=p("<div />").addClass(r("header-right")).appendTo(this.$header);var f=this.$body=p("<div />").addClass(r("body")).appendTo(this.$el);this.recomputeBottomOffset();var c,d;this.$resizehdle.on("mousedown",function(g){d=f.height(),c=g.pageY;f.parents().on("mousemove",a).on("mouseup",e);b.$dragCapture.show();g.preventDefault()});var a=function(g){var h=d+(c-g.pageY);b.setHeight(h)};var e=function(){f.parents().off("mousemove",a).off("mouseup",e);b.$dragCapture.hide()};this.$closebtn=p("<a />").addClass(r("close-btn")).appendTo(this.$headerRight);this.$closebtn.click(function(){b.close()});this.$minimizebtn=p("<a />").addClass(r("minimize-btn")).appendTo(this.$headerRight);this.$minimizebtn.click(function(){b.minimize()});this.$maximizebtn=p("<a />").addClass(r("maximize-btn")).appendTo(this.$headerRight);this.$maximizebtn.click(function(){b.restore()});this.$restorebtn=p("<a />").addClass(r("restore-btn")).hide().appendTo(this.$el);this.$restorebtn.click(function(){b.restore()});this.$openbtn=p("<a />").addClass(r("open-btn")).appendTo(this.$headerRight).hide();this.$openbtn.click(function(){b.openHandler.show(function(g,h){b.addDataSet(h,g,"(opened)");b.showTab()})});this.$datasets=p("<select />").addClass(r("datasets-switcher")).appendTo(this.$headerRight);this.$datasets.change(function(){b.dataChangeHandler(b.datasets[this.value]);b.showTab()})},setHeight:function(c){var a=40;var b=p(window).innerHeight()-this.$header.height()-10;c=Math.min(c,b);c=Math.max(c,a);this.$body.css("height",c);localStorage.setItem("phpdebugbar-height",c);this.recomputeBottomOffset()},restoreState:function(){var c=localStorage.getItem("phpdebugbar-height");this.setHeight(c||this.$body.height());var b=localStorage.getItem("phpdebugbar-open");if(b&&b=="0"){this.close()}else{var d=localStorage.getItem("phpdebugbar-visible");if(d&&d=="1"){var a=localStorage.getItem("phpdebugbar-tab");if(this.isTab(a)){this.showTab(a)}}}},createTab:function(c,a,d){var b=new t({title:d||(c.replace(/[_\-]/g," ").charAt(0).toUpperCase()+c.slice(1)),widget:a});return this.addTab(c,b)},addTab:function(b,a){if(this.isControl(b)){throw new Error(b+" already exists")}var c=this;a.$tab.appendTo(this.$headerLeft).click(function(){if(!c.isMinimized()&&c.activePanelName==b){c.minimize()}else{c.showTab(b)}});a.$el.appendTo(this.$body);this.controls[b]=a;if(this.firstTabName==null){this.firstTabName=b}return a},createIndicator:function(a,e,d,c){var b=new k({icon:e,tooltip:d});return this.addIndicator(a,b,c)},addIndicator:function(a,b,c){if(this.isControl(a)){throw new Error(a+" already exists")}if(c=="left"){b.$el.insertBefore(this.$headerLeft.children().first())}else{b.$el.appendTo(this.$headerRight)}this.controls[a]=b;return b},getControl:function(a){if(this.isControl(a)){return this.controls[a]}},isControl:function(a){return typeof(this.controls[a])!="undefined"},isTab:function(a){return this.isControl(a)&&this.controls[a] instanceof t},isIndicator:function(a){return this.isControl(a)&&this.controls[a] instanceof k},reset:function(){this.minimize();var a=this;p.each(this.controls,function(c,b){if(a.isTab(c)){b.$tab.remove()}b.$el.remove()});this.controls={}},showTab:function(a){if(!a){if(this.activePanelName){a=this.activePanelName}else{a=this.firstTabName}}if(!this.isTab(a)){throw new Error("Unknown tab '"+a+"'")}this.$resizehdle.show();this.$body.show();this.recomputeBottomOffset();p(this.$header).find("> div > ."+r("active")).removeClass(r("active"));p(this.$body).find("> ."+r("active")).removeClass(r("active"));this.controls[a].$tab.addClass(r("active"));this.controls[a].$el.addClass(r("active"));this.activePanelName=a;this.$el.removeClass(r("minimized"));localStorage.setItem("phpdebugbar-visible","1");localStorage.setItem("phpdebugbar-tab",a);this.resize()},minimize:function(){this.$header.find("> div > ."+r("active")).removeClass(r("active"));this.$body.hide();this.$resizehdle.hide();this.recomputeBottomOffset();localStorage.setItem("phpdebugbar-visible","0");this.$el.addClass(r("minimized"));this.resize()},isMinimized:function(){return this.$el.hasClass(r("minimized"))},close:function(){this.$resizehdle.hide();this.$header.hide();this.$body.hide();this.$restorebtn.show();localStorage.setItem("phpdebugbar-open","0");this.$el.addClass(r("closed"));this.recomputeBottomOffset()},isClosed:function(){return this.$el.hasClass(r("closed"))},restore:function(){this.$resizehdle.show();this.$header.show();this.$restorebtn.hide();localStorage.setItem("phpdebugbar-open","1");var a=localStorage.getItem("phpdebugbar-tab");if(this.isTab(a)){this.showTab(a)}this.$el.removeClass(r("closed"));this.resize()},recomputeBottomOffset:function(){if(this.options.bodyMarginBottom){if(this.isClosed()){return p("body").css("margin-bottom",this.options.bodyMarginBottomHeight||"")}var a=parseInt(this.$el.height())+this.options.bodyMarginBottomHeight;p("body").css("margin-bottom",a)}},setDataMap:function(a){this.dataMap=a},addDataMap:function(a){p.extend(this.dataMap,a)},setData:function(a){this.datasets={};return this.addDataSet(a)},addDataSet:function(b,d,a){var c=this.datesetTitleFormater.format(d,b,a);d=d||(l(this.datasets)+1);this.datasets[d]=b;this.$datasets.append(p('<option value="'+d+'">'+c+"</option>"));if(this.$datasets.children().length>1){this.$datasets.show()}this.showDataSet(d);return d},loadDataSet:function(d,b,a){if(!this.openHandler){throw new Error("loadDataSet() needs an open handler")}var c=this;this.openHandler.load(d,function(e){c.addDataSet(e,d,b);a&&a(e)})},getDataSet:function(a){return this.datasets[a]},showDataSet:function(a){this.dataChangeHandler(this.datasets[a]);this.$datasets.val(a)},dataChangeHandler:function(a){var b=this;p.each(this.dataMap,function(c,e){var d=m(a,e[0],e[1]);if(c.indexOf(":")!=-1){c=c.split(":");b.getControl(c[0]).set(c[1],d)}else{b.getControl(c).set("data",d)}})},setOpenHandler:function(a){this.openHandler=a;if(a!==null){this.$openbtn.show()}else{this.$openbtn.hide()}},getOpenHandler:function(){return this.openHandler}});s.Tab=t;s.Indicator=k;var q=PhpDebugBar.AjaxHandler=function(b,a){this.debugbar=b;this.headerName=a||"phpdebugbar"};p.extend(q.prototype,{handle:function(a){if(!this.loadFromId(a)){return this.loadFromData(a)}return true},loadFromId:function(b){var a=this.extractIdFromHeaders(b);if(a&&this.debugbar.openHandler){this.debugbar.loadDataSet(a,"(ajax)");return true}return false},extractIdFromHeaders:function(a){return a.getResponseHeader(this.headerName+"-id")},loadFromData:function(a){var c=this.extractDataFromHeaders(a);if(!c){return false}var b=this.parseHeaders(c);if(b.error){throw new Error("Error loading debugbar data: "+b.error)}else{if(b.data){this.debugbar.addDataSet(b.data,b.id,"(ajax)")}}return true},extractDataFromHeaders:function(a){var b=a.getResponseHeader(this.headerName);if(!b){return}for(var c=1;;c++){var d=a.getResponseHeader(this.headerName+"-"+c);if(!d){break}b+=d}return decodeURIComponent(b)},parseHeaders:function(a){return JSON.parse(a)},bindToJquery:function(a){var b=this;a(document).ajaxComplete(function(e,d,c){if(!c.ignoreDebugBarAjaxHandler){b.handle(d)}})},bindToXHR:function(){var b=this;var a=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(d,h,g,c,f){var e=this;this.addEventListener("readystatechange",function(){var i=b.debugbar.openHandler?b.debugbar.openHandler.get("url"):null;if(e.readyState==4&&h.indexOf(i)!==0){b.handle(e)}},false);a.apply(this,Array.prototype.slice.call(arguments))}}})})(PhpDebugBar.$);