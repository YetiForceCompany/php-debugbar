if(typeof(PhpDebugBar)=="undefined"){var PhpDebugBar={};PhpDebugBar.$=jQuery}(function(c){var d=function(a){return PhpDebugBar.utils.csscls(a,"phpdebugbar-openhandler-")};PhpDebugBar.OpenHandler=PhpDebugBar.Widget.extend({className:"phpdebugbar-openhandler",defaults:{items_per_page:20},render:function(){var a=this;this.$el.appendTo("body").hide();this.$closebtn=c('<a><i class="phpdebugbar-fa phpdebugbar-fa-times"></i></a>');this.$table=c("<tbody />");c("<div>PHP DebugBar | Open</div>").addClass(d("header")).append(this.$closebtn).appendTo(this.$el);c('<table><thead><tr><th width="150">Date</th><th width="55">Method</th><th>URL</th><th width="125">IP</th><th width="100">Filter data</th></tr></thead></table>').append(this.$table).appendTo(this.$el);this.$actions=c("<div />").addClass(d("actions")).appendTo(this.$el);this.$closebtn.on("click",function(){a.hide()});this.$loadmorebtn=c("<a>Load more</a>").appendTo(this.$actions).on("click",function(){a.find(a.last_find_request,a.last_find_request.offset+a.get("items_per_page"),a.handleFind.bind(a))});this.$showonlycurrentbtn=c("<a>Show only current URL</a>").appendTo(this.$actions).on("click",function(){a.$table.empty();a.find({uri:window.location.pathname},0,a.handleFind.bind(a))});this.$showallbtn=c("<a>Show all</a>").appendTo(this.$actions).on("click",function(){a.refresh()});this.$clearbtn=c("<a>Delete all</a>").appendTo(this.$actions).on("click",function(){a.clear(function(){a.hide()})});this.addSearch();this.$overlay=c("<div />").addClass(d("overlay")).hide().appendTo("body");this.$overlay.on("click",function(){a.hide()})},refresh:function(){this.$table.empty();this.$loadmorebtn.show();this.find({},0,this.handleFind.bind(this))},addSearch:function(){var b=this;var a=c("<button />").text("Search").attr("type","submit").on("click",function(e){b.$table.empty();var i={};var j=c(this).parent().serializeArray();c.each(j,function(){if(this.value){i[this.name]=this.value}});b.find(i,0,b.handleFind.bind(b));e.preventDefault()});c("<form />").append("<br/><b>Filter results</b><br/>").append('Method: <select name="method"><option></option><option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option></select><br/>').append('Uri: <input type="text" name="uri"><br/>').append('IP: <input type="text" name="ip"><br/>').append(a).appendTo(this.$actions)},handleFind:function(a){var b=this;c.each(a,function(p,n){var r=c("<a />").text("Load dataset").on("click",function(e){b.hide();b.load(n.id,function(f){b.callback(n.id,f)});e.preventDefault()});var i=c("<a />").text(n.method).on("click",function(e){b.$table.empty();b.find({method:n.method},0,b.handleFind.bind(b));e.preventDefault()});var o=c("<a />").text(n.uri).on("click",function(e){b.hide();b.load(n.id,function(f){b.callback(n.id,f)});e.preventDefault()});var m=c("<a />").text(n.ip).on("click",function(e){b.$table.empty();b.find({ip:n.ip},0,b.handleFind.bind(b));e.preventDefault()});var q=c("<a />").text("Show URL").on("click",function(e){b.$table.empty();b.find({uri:n.uri},0,b.handleFind.bind(b));e.preventDefault()});c("<tr />").append("<td>"+n.datetime+"</td>").append("<td>"+n.method+"</td>").append(c("<td />").append(o)).append(c("<td />").append(m)).append(c("<td />").append(q)).appendTo(b.$table)});if(a.length<this.get("items_per_page")){this.$loadmorebtn.hide()}},show:function(a){this.callback=a;this.$el.show();this.$overlay.show();this.refresh()},hide:function(){this.$el.hide();this.$overlay.hide()},find:function(h,b,a){var g=c.extend({},h,{max:this.get("items_per_page"),offset:b||0});this.last_find_request=g;this.ajax(g,a)},load:function(a,b){this.ajax({op:"get",id:a},b)},clear:function(a){this.ajax({op:"clear"},a)},ajax:function(b,a){c.ajax({dataType:"json",url:this.get("url"),data:b,success:a,ignoreDebugBarAjaxHandler:true})}})})(PhpDebugBar.$);